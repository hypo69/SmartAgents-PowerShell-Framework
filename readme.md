# Update.
mcp —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–µ—Ö–∞–ª –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: https://github.com/hypo69/mcp-powershell-server



# SmartAgents Framework

–ú–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö AI-–∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ PowerShell —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Google Gemini API –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π MCP (Model Context Protocol).

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- PowerShell 7+
- [Gemini CLI](https://github.com/google-gemini/gemini-cli)
- –ú–æ–¥—É–ª—å Microsoft.PowerShell.ConsoleGuiTools: `Install-Module Microsoft.PowerShell.ConsoleGuiTools`
- Google Gemini API –∫–ª—é—á

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç:

```powershell
.\install.ps1 -ApiKey "–í–ê–®_GEMINI_API_–ö–õ–Æ–ß"
```

3. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –º–æ–¥—É–ª—å:

```powershell
Import-Module .\SmartAgents.psd1
```

### üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MCP (Model Context Protocol)

SmartAgents Framework —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å MCP –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è PowerShell –∫–æ–º–∞–Ω–¥ —á–µ—Ä–µ–∑ Gemini CLI.

#### –ó–∞–ø—É—Å–∫ MCP —Å–µ—Ä–≤–µ—Ä–∞ —Å Gemini CLI

```powershell
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ MCP —Å–µ—Ä–≤–µ—Ä–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Gemini CLI
.\start-mcp-gemini.ps1 -ApiKey "–í–ê–®_GEMINI_API_–ö–õ–Æ–ß"

# –ó–∞–ø—É—Å–∫ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å—Ç–∞—Ä—Ç–æ–º Gemini CLI
.\start-mcp-gemini.ps1 -ApiKey "–í–ê–®_API_–ö–õ–Æ–ß" -LaunchGemini

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ –º–æ—â–Ω–æ–π –º–æ–¥–µ–ª–∏
.\start-mcp-gemini.ps1 -ApiKey "–í–ê–®_API_–ö–õ–Æ–ß" -LaunchGemini -Model "gemini-2.5-pro"
```

#### –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ MCP —Å–µ—Ä–≤–µ—Ä–æ–º

```powershell
# –ó–∞–ø—É—Å–∫ MCP —Å–µ—Ä–≤–µ—Ä–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –æ–∫–Ω–µ
.\mcp-powershell-server\launch-mcp-stdio.ps1

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Gemini CLI —Å MCP
gemini --mcp-config ./config/mcp_servers.json -m gemini-2.5-flash -p "–í—ã–ø–æ–ª–Ω–∏ PowerShell –∫–æ–º–∞–Ω–¥—É Get-Process"
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤

```powershell
# –ê–≥–µ–Ω—Ç –ø–æ–∏—Å–∫–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π
Start-FindSpecAgent
Start-FindSpecAgent -ApiKey "–í–ê–®_API_–ö–õ–Æ–ß"

# –ê–≥–µ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–ª–µ—Ç–æ–≤
Start-FlightPlanAgent
Start-FlightPlanAgent -ApiKey "–í–ê–®_API_–ö–õ–Æ–ß"

# –ò–ª–∏ —á–µ—Ä–µ–∑ –ø—Å–µ–≤–¥–æ–Ω–∏–º—ã
find-spec
find-spec -ApiKey "–í–ê–®_API_–ö–õ–Æ–ß"
flight-plan
flight-plan -ApiKey "–í–ê–®_API_–ö–õ–Æ–ß"
```

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **SmartAgents Framework** - –û—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≥–µ–Ω—Ç–æ–≤
2. **MCP PowerShell Server** - –°–µ—Ä–≤–µ—Ä –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è PowerShell –∫–æ–º–∞–Ω–¥
3. **Gemini CLI Integration** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Gemini CLI —á–µ—Ä–µ–∑ MCP

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
SmartAgents/
‚îú‚îÄ‚îÄ SmartAgents.psm1                    # –Ø–¥—Ä–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞
‚îú‚îÄ‚îÄ SmartAgents.psd1                    # –ú–∞–Ω–∏—Ñ–µ—Å—Ç –º–æ–¥—É–ª—è
‚îú‚îÄ‚îÄ install.ps1                         # –£—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ start-mcp-gemini.ps1               # üÜï –ì–ª–∞–≤–Ω—ã–π launcher MCP + Gemini
‚îú‚îÄ‚îÄ Manage-Agents.ps1                  # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞–º–∏
‚îú‚îÄ‚îÄ config/                            # üÜï –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ mcp_servers.json               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è MCP —Å–µ—Ä–≤–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ mcp-powershell-server/             # üÜï MCP PowerShell Server
‚îÇ   ‚îú‚îÄ‚îÄ mcp-powershell-stdio.ps1      # –û—Å–Ω–æ–≤–Ω–æ–π MCP —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ launch-mcp-stdio.ps1          # Launcher –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ start-mcp-server.ps1          # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫
‚îú‚îÄ‚îÄ Agents/                            # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ Find-Spec.ps1                 # –ê–≥–µ–Ω—Ç –ø–æ–∏—Å–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ Flight-Plan.ps1               # –ê–≥–µ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–ª–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ FindSpec/                          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞ –ø–æ–∏—Å–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ .gemini/
‚îÇ       ‚îú‚îÄ‚îÄ GEMINI.md                 # –°–∏—Å—Ç–µ–º–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
‚îÇ       ‚îî‚îÄ‚îÄ ShowHelp.md               # –°–ø—Ä–∞–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îî‚îÄ‚îÄ FlightPlan/                        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞ –ø–µ—Ä–µ–ª–µ—Ç–æ–≤
    ‚îî‚îÄ‚îÄ .gemini/
        ‚îú‚îÄ‚îÄ GEMINI.md                 # –°–∏—Å—Ç–µ–º–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
        ‚îî‚îÄ‚îÄ ShowHelp.md               # –°–ø—Ä–∞–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

## ü§ñ MCP PowerShell Server

### –ß—Ç–æ —Ç–∞–∫–æ–µ MCP?

Model Context Protocol (MCP) ‚Äî —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–≤ –∫ –≤–Ω–µ—à–Ω–∏–º —Å–∏—Å—Ç–µ–º–∞–º –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç Gemini CLI –≤—ã–ø–æ–ª–Ω—è—Ç—å PowerShell –∫–æ–º–∞–Ω–¥—ã.

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ MCP —Å–µ—Ä–≤–µ—Ä–∞

- ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ PowerShell —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏ –∫–æ–º–∞–Ω–¥
- ‚úÖ –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å —Ç–∞–π–º–∞—É—Ç–æ–≤
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è MCP

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ MCP —Å–µ—Ä–≤–µ—Ä–∞ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Gemini CLI –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è PowerShell –∫–æ–º–∞–Ω–¥:

```powershell
# –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
gemini --mcp-config ./config/mcp_servers.json -p "–ü–æ–∫–∞–∂–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∏—Å—Ç–µ–º–µ —á–µ—Ä–µ–∑ PowerShell"

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
gemini -p "–ù–∞–π–¥–∏ –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã Chrome –∏ –ø–æ–∫–∞–∂–∏ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏"

# –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏
gemini -p "–°–æ–∑–¥–∞–π –æ—Ç—á–µ—Ç –æ –∑–∞–Ω—è—Ç–æ–º –¥–∏—Å–∫–æ–≤–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ"

# –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
gemini -p "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ª–æ–≥–∞ Windows"
```

## üìã –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≥–µ–Ω—Ç–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `Agents/YourAgent.ps1`:

```powershell
## \file Agents/YourAgent.ps1
# -*- coding: utf-8 -*-
#! .pyenv/bin/powershell

"""
–ê–≥–µ–Ω—Ç –¥–ª—è [–æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è]
===============================

.. module:: SmartAgents.YourAgent
"""

function Start-YourAgent {
    <#
    .SYNOPSIS
        –ó–∞–ø—É—Å–∫ –≤–∞—à–µ–≥–æ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ AI-–∞–≥–µ–Ω—Ç–∞
    
    .PARAMETER Model
        –ú–æ–¥–µ–ª—å Gemini –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    
    .PARAMETER ApiKey
        API –∫–ª—é—á Google Gemini (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è)
    
    .EXAMPLE
        Start-YourAgent
        –ó–∞–ø—É—Å–∫–∞–µ—Ç –∞–≥–µ–Ω—Ç–∞ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    #>
    [CmdletBinding()]
    param(
        [ValidateSet('gemini-2.5-pro', 'gemini-2.5-flash')]
        [string]$Model = 'gemini-2.5-flash',
        [string]$ApiKey
    )
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–∞
    $agentRoot = $PSScriptRoot 
    $Config = New-GeminiConfig -AppName '–í–∞—à –∞–≥–µ–Ω—Ç' -Emoji 'üéØ' -SessionPrefix 'your_session' -AgentRoot $agentRoot

    # –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≥–µ–Ω—Ç–∞
    function Show-YourAgentHelp {
        """–§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–ø—Ä–∞–≤–∫—É –ø–æ –∞–≥–µ–Ω—Ç—É"""
        $helpFilePath = Join-Path $Config.ConfigDir "ShowHelp.md"
        if (-not (Test-Path $helpFilePath)) {
            Write-Warning "–§–∞–π–ª —Å–ø—Ä–∞–≤–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω: $helpFilePath"
            return
        }
        Get-Content -Path $helpFilePath -Raw | Write-Host
    }

    function Show-History {
        """–§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Å–µ—Å—Å–∏–∏"""
        param([string]$HistoryFilePath)
        if (-not (Test-Path $HistoryFilePath)) {
            Write-ColoredMessage "–ò—Å—Ç–æ—Ä–∏—è —Å–µ—Å—Å–∏–∏ –ø—É—Å—Ç–∞." -Color $Config.Color.Warning
            return
        }
        Get-Content $HistoryFilePath | ForEach-Object {
            $entry = $_ | ConvertFrom-Json
            if ($entry.user) {
                Write-ColoredMessage "USER: $($entry.user)" -Color $Config.Color.Info
            }
            if ($entry.model) {
                Write-ColoredMessage "MODEL: $($entry.model)" -Color 'White'
            }
        }
    }

    function Clear-History {
        """–§—É–Ω–∫—Ü–∏—è –æ—á–∏—â–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Å–µ—Å—Å–∏–∏"""
        param([string]$HistoryFilePath)
        if (Test-Path $HistoryFilePath) {
            Remove-Item $HistoryFilePath -Force
        }
        Write-ColoredMessage "–ò—Å—Ç–æ—Ä–∏—è —Å–µ—Å—Å–∏–∏ –æ—á–∏—â–µ–Ω–∞." -Color $Config.Color.Warning
    }

    function Command-Handler-YourAgent {
        """–§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∞–≥–µ–Ω—Ç–∞"""
        param([string]$Command, [string]$HistoryFilePath)
        switch ($Command.Trim().ToLower()) {
            '?'         { Show-YourAgentHelp; return 'continue' }
            'help'      { Show-YourAgentHelp; return 'continue' }
            'history'   { Show-History -HistoryFilePath $HistoryFilePath; return 'continue' }
            'clear'     { Clear-History -HistoryFilePath $HistoryFilePath; return 'continue' }
            'exit'      { return 'break' }
            'quit'      { return 'break' }
            # –î–æ–±–∞–≤—å—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –≤–∞—à–µ–≥–æ –∞–≥–µ–Ω—Ç–∞
            'export'    { Export-YourAgentData; return 'continue' }
            'settings'  { Show-YourAgentSettings; return 'continue' }
            default     { return $null }
        }
    }

    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∞—à–µ–≥–æ –∞–≥–µ–Ω—Ç–∞
    function Export-YourAgentData {
        """–§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∞–≥–µ–Ω—Ç–∞"""
        Write-ColoredMessage "–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö..." -Color $Config.Color.Info
        # –õ–æ–≥–∏–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞
    }

    function Show-YourAgentSettings {
        """–§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≥–µ–Ω—Ç–∞"""
        Write-ColoredMessage "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≥–µ–Ω—Ç–∞:" -Color $Config.Color.Info
        # –õ–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
    }

    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Å—Å–∏–∏
    try {
        $historyFilePath = Initialize-GeminiSession -Config $Config -ApiKey $ApiKey
    } catch {
        Write-ColoredMessage "–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: $($_.Exception.Message)" -Color $Config.Color.Error
        return
    }

    Write-Host "`n–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ $($Config.AppName)! –ú–æ–¥–µ–ª—å: '$Model'. –í–≤–µ–¥–∏—Ç–µ '?' –¥–ª—è –ø–æ–º–æ—â–∏, 'exit' –¥–ª—è –≤—ã—Ö–æ–¥–∞.`n"
    $selectionContextJson = $null 
    
    # –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
    while ($true) {
        $promptText = if ($selectionContextJson) { "$($Config.Emoji)AI [–í—ã–±–æ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞] :) > " } else { "$($Config.Emoji)AI :) > " }
        Write-ColoredMessage -Message $promptText -Color $Config.Color.Prompt -NoNewline
        $UserPrompt = Read-Host
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
        $commandResult = Command-Handler-YourAgent -Command $UserPrompt -HistoryFilePath $historyFilePath
        if ($commandResult -eq 'break') { break }
        if ($commandResult -eq 'continue') { continue }
        if ([string]::IsNullOrWhiteSpace($UserPrompt)) { continue }

        Write-ColoredMessage "–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞..." -Color $Config.Color.Processing
        
        # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ —Å –∏—Å—Ç–æ—Ä–∏–µ–π –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
        $historyContent = if (Test-Path $historyFilePath) { Get-Content -Path $historyFilePath -Raw } else { "" }
        $fullPrompt = "### –ò–°–¢–û–†–ò–Ø`n$historyContent`n"
        if ($selectionContextJson) {
            $fullPrompt += "### –í–´–ë–û–†–ö–ê`n$selectionContextJson`n"
            $selectionContextJson = $null
        }
        $fullPrompt += "### –ù–û–í–´–ô –ó–ê–ü–†–û–°`n$UserPrompt"
        
        # –ó–∞–ø—Ä–æ—Å –∫ Gemini API
        $ModelResponse = Invoke-GeminiAPI -Prompt $fullPrompt -Model $Model -Config $Config
        
        if ($ModelResponse) {
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ JSON —Ñ–æ—Ä–º–∞—Ç
            $jsonObject = ConvertTo-JsonData -GeminiResponse $ModelResponse
            if ($jsonObject) {
                Write-ColoredMessage "`n--- –†–µ–∑—É–ª—å—Ç–∞—Ç ---`n" -Color $Config.Color.Success
                $gridSelection = $jsonObject | Out-ConsoleGridView -Title "–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞" -OutputMode Multiple
                if ($gridSelection) {
                    $selectionContextJson = $gridSelection | ConvertTo-Json -Compress -Depth 10
                    Write-ColoredMessage "–í—ã–±–æ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞. –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å." -Color $Config.Color.Selection
                }
            } else {
                Write-ColoredMessage $ModelResponse -Color 'White'
            }
            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
            Add-ChatHistory -HistoryFilePath $historyFilePath -UserPrompt $UserPrompt -ModelResponse $ModelResponse
        }
    }
    Write-ColoredMessage "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã." -Color $Config.Color.Success
}
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ –¥–ª—è –≤–∞—à–µ–≥–æ –∞–≥–µ–Ω—Ç–∞:

```
YourAgent/
‚îî‚îÄ‚îÄ .gemini/
    ‚îú‚îÄ‚îÄ GEMINI.md      # –°–∏—Å—Ç–µ–º–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è AI
    ‚îî‚îÄ‚îÄ ShowHelp.md    # –°–ø—Ä–∞–≤–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `YourAgent/.gemini/GEMINI.md`:

```markdown
# –°–ò–°–¢–ï–ú–ù–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø –î–õ–Ø YourAgent AI

## 1. –¢–≤–æ—è –†–æ–ª—å –∏ –ì–ª–∞–≤–Ω–∞—è –ó–∞–¥–∞—á–∞

–¢—ã ‚Äî —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è [–æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏].
–¢–≤–æ—è —Ü–µ–ª—å ‚Äî [–æ–ø–∏—Å–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≥–µ–Ω—Ç–∞].

## 2. –û—Å–Ω–æ–≤–Ω—ã–µ –î–∏—Ä–µ–∫—Ç–∏–≤—ã

### 2.1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ —Ç–∏–ø–∞ [–ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤] –≤—ã–ø–æ–ª–Ω—è–π –ø–æ–∏—Å–∫/–∞–Ω–∞–ª–∏–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ù–µ –∑–∞–¥–∞–≤–∞–π —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ

### 2.2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—Å—Ç–∏
–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–µ–Ω, –≤–µ—Ä–Ω–∏ JSON-—Å–ø–∏—Å–æ–∫ —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏:

```json
[
  {"–í–∞—Ä–∏–∞–Ω—Ç": "–í–∞—Ä–∏–∞–Ω—Ç 1", "–£—Ç–æ—á–Ω–µ–Ω–∏–µ": "–û–ø–∏—Å–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞"},
  {"–í–∞—Ä–∏–∞–Ω—Ç": "–í–∞—Ä–∏–∞–Ω—Ç 2", "–£—Ç–æ—á–Ω–µ–Ω–∏–µ": "–û–ø–∏—Å–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞"}
]
```

## 3. –§–æ—Ä–º–∞—Ç –û—Ç–≤–µ—Ç–æ–≤

### 3.1. –í–°–ï–ì–î–ê JSON (–∫—Ä–æ–º–µ –æ—à–∏–±–æ–∫)
–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –¢–û–õ–¨–ö–û –≤ –≤–∏–¥–µ –≤–∞–ª–∏–¥–Ω–æ–≥–æ JSON.

### 3.2. –§–æ—Ä–º–∞—Ç –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```json
[
  {"–ü–∞—Ä–∞–º–µ—Ç—Ä": "–ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞", "–ó–Ω–∞—á–µ–Ω–∏–µ": "–ó–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞"},
  {"–ü–∞—Ä–∞–º–µ—Ç—Ä": "–î—Ä—É–≥–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä", "–ó–Ω–∞—á–µ–Ω–∏–µ": "–î—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ"}
]
```

### 3.3. –§–æ—Ä–º–∞—Ç –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
```json
[
  {"–ü–∞—Ä–∞–º–µ—Ç—Ä": "–ü–∞—Ä–∞–º–µ—Ç—Ä", "–û–±—ä–µ–∫—Ç1": "–ó–Ω–∞—á–µ–Ω–∏–µ1", "–û–±—ä–µ–∫—Ç2": "–ó–Ω–∞—á–µ–Ω–∏–µ2"}
]
```

## 4. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞

[–î–æ–±–∞–≤—å—Ç–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –≤–∞—à–µ–≥–æ –∞–≥–µ–Ω—Ç–∞]

### 4.1. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∏–ø–∏—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
[–ü—Ä–∏–º–µ—Ä—ã —Ç–∏–ø–∏—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ–∂–∏–¥–∞–µ–º—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤]

### 4.2. –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
[–£–∫–∞–∂–∏—Ç–µ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏]

## 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, –≤–µ—Ä–Ω–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç (–Ω–µ JSON):
`–ü–æ–∏—Å–∫ –ø–æ "[–∑–∞–ø—Ä–æ—Å]" –Ω–µ –¥–∞–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. [–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –∑–∞–ø—Ä–æ—Å–∞]`
```

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `YourAgent/.gemini/ShowHelp.md`:

```markdown
# –°–ø—Ä–∞–≤–∫–∞ –ø–æ YourAgent

## –û—Å–Ω–æ–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
[–û–ø–∏—Å–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –∞–≥–µ–Ω—Ç–∞]

–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:
- `–ø—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ 1`
- `–ø—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ 2`

## –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
- –ö–æ–≥–¥–∞ AI –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É, –æ–Ω–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º –æ–∫–Ω–µ
- –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ (Click –∏–ª–∏ –ø—Ä–æ–±–µ–ª)
- –ù–∞–∂–º–∏—Ç–µ OK –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã–±–æ—Ä–∫–∏
- –ù–∞–∂–º–∏—Ç–µ Cancel –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è

## –†–∞–±–æ—Ç–∞ —Å –≤—ã–±–æ—Ä–∫–æ–π
–ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã–±–æ—Ä–∫–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è –Ω–∞ `üéØAI [–í—ã–±–æ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞] :) >`
–¢–µ–ø–µ—Ä—å –≤–∞—à —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—ã–±–æ—Ä–∫–∏:
- `—Å—Ä–∞–≤–Ω–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã`
- `–Ω–∞–π–¥–∏ –∞–Ω–∞–ª–æ–≥–∏`
- `–ø–æ–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏`

## –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
- `?` –∏–ª–∏ `help` - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É
- `history` - –ü–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–µ—Å—Å–∏–∏
- `clear` - –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
- `export` - –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- `settings` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≥–µ–Ω—Ç–∞
- `exit` / `quit` - –í—ã—Ö–æ–¥

## –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
[–î–æ–±–∞–≤—å—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –≤–∞—à–µ–≥–æ –∞–≥–µ–Ω—Ç–∞]
```

### –®–∞–≥ 5: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞ –≤ –º–æ–¥—É–ª–µ

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `SmartAgents.psd1`, –¥–æ–±–∞–≤–∏–≤ –≤–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é –∏ –ø—Å–µ–≤–¥–æ–Ω–∏–º:

```powershell
FunctionsToExport = @(
    'Start-FindSpecAgent',
    'Start-FlightPlanAgent',
    'Start-YourAgent'  # –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é
)

AliasesToExport = @(
    'find-spec',
    'flight-plan',
    'your-agent'       # –î–æ–±–∞–≤—å—Ç–µ –ø—Å–µ–≤–¥–æ–Ω–∏–º
)
```

## ‚öôÔ∏è –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ API

```powershell
function Get-ExternalApiData {
    """–§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ API"""
    param(
        [string]$Endpoint,
        [hashtable]$Parameters = @{}
    )
    
    try {
        $response = Invoke-RestMethod -Uri $Endpoint -Method GET -Body $Parameters -ContentType "application/json"
        return $response
    } catch {
        Write-ColoredMessage "–û—à–∏–±–∫–∞ API –∑–∞–ø—Ä–æ—Å–∞: $($_.Exception.Message)" -Color $Config.Color.Error
        return $null
    }
}
```

### MCP –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –∞–≥–µ–Ω—Ç–∞—Ö

–í–∞—à–∏ –∞–≥–µ–Ω—Ç—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MCP —Å–µ—Ä–≤–µ—Ä –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è PowerShell –∫–æ–º–∞–Ω–¥:

```powershell
function Invoke-AgentPowerShell {
    """–§—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç PowerShell –∫–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ MCP"""
    param([string]$Script)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ MCP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    $mcpConfig = Join-Path $PSScriptRoot '../config/mcp_servers.json'
    if (-not (Test-Path $mcpConfig)) {
        Write-ColoredMessage "MCP —Å–µ—Ä–≤–µ—Ä –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ó–∞–ø—É—Å—Ç–∏—Ç–µ start-mcp-gemini.ps1" -Color $Config.Color.Warning
        return $null
    }
    
    try {
        $prompt = "–í—ã–ø–æ–ª–Ω–∏ PowerShell –∫–æ–º–∞–Ω–¥—É: $Script"
        $result = & gemini --mcp-config $mcpConfig -m $Model -p $prompt
        return $result
    } catch {
        Write-ColoredMessage "–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ MCP: $($_.Exception.Message)" -Color $Config.Color.Error
        return $null
    }
}
```

## üîç –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–º

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∞–≥–µ–Ω—Ç–æ–≤ –∏ MCP

```powershell
# –°—Ç–∞—Ç—É—Å –∞–≥–µ–Ω—Ç–æ–≤
.\Manage-Agents.ps1 -Action Status

# –ü—Ä–æ–≤–µ—Ä–∫–∞ MCP —Å–µ—Ä–≤–µ—Ä–∞
Test-NetConnection -ComputerName localhost -Port 8090
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `config/mcp_servers.json` - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è MCP —Å–µ—Ä–≤–µ—Ä–æ–≤
- `YourAgent/.gemini/GEMINI.md` - –°–∏—Å—Ç–µ–º–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è AI
- `YourAgent/.gemini/ShowHelp.md` - –°–ø—Ä–∞–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ MCP + –ê–≥–µ–Ω—Ç—ã

### –°–∏—Å—Ç–µ–º–Ω—ã–π –∞–≥–µ–Ω—Ç —Å MCP

```powershell
function Start-SystemMonitorAgent {
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞
    $Config = New-GeminiConfig -AppName '–°–∏—Å—Ç–µ–º–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä' -Emoji 'üñ•Ô∏è' -SessionPrefix 'system_monitor'
    
    # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MCP –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    function Get-SystemInfo {
        $script = @"
        Get-ComputerInfo | Select-Object WindowsProductName, WindowsVersion, 
        TotalPhysicalMemory, AvailablePhysicalMemory, CsProcessors
"@
        return Invoke-AgentPowerShell -Script $script
    }
    
    # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º —Ü–∏–∫–ª–æ–º –∞–≥–µ–Ω—Ç–∞...
}
```

### –ê–≥–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```powershell
function Start-PerformanceAgent {
    # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —á–µ—Ä–µ–∑ MCP
    function Get-TopProcesses {
        $script = "Get-Process | Sort-Object CPU -Descending | Select-Object -First 10 Name, CPU, WorkingSet"
        return Invoke-AgentPowerShell -Script $script
    }
    
    # –ê–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–∞
    function Get-DiskUsage {
        $script = "Get-WmiObject -Class Win32_LogicalDisk | Select-Object DeviceID, Size, FreeSpace"
        return Invoke-AgentPowerShell -Script $script
    }
}
```

## üìä –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MCP

- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: MCP —Å–µ—Ä–≤–µ—Ä –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ
- **–¢–∞–π–º–∞—É—Ç—ã**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: MCP —Å–µ—Ä–≤–µ—Ä –≤–µ–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤ `%TEMP%/mcp-powershell-server.log`
- **–û—à–∏–±–∫–∏**: –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è
- –î–æ–±–∞–≤–ª—è–π—Ç–µ docstrings –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –°–ª–µ–¥—É–π—Ç–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è–º –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è PowerShell

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```powershell
try {
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ MCP
    if (-not (Test-Path $mcpConfigFile)) {
        Write-ColoredMessage "MCP —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω" -Color $Config.Color.Warning
        return
    }
    
    $result = Invoke-AgentPowerShell -Script $powerShellScript
    if (-not $result) {
        Write-ColoredMessage "–û–ø–µ—Ä–∞—Ü–∏—è –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞" -Color $Config.Color.Warning
        return
    }
} catch {
    Write-ColoredMessage "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: $($_.Exception.Message)" -Color $Config.Color.Error
    return
}
```

### 4. –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ü–≤–µ—Ç–∞ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

- `$Config.Color.Success` - —É—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–∑–µ–ª–µ–Ω—ã–π)
- `$Config.Color.Warning` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–∂–µ–ª—Ç—ã–π) 
- `$Config.Color.Error` - –æ—à–∏–±–∫–∏ (–∫—Ä–∞—Å–Ω—ã–π)
- `$Config.Color.Info` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–≥–æ–ª—É–±–æ–π)
- `$Config.Color.Processing` - –ø—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ (—Å–µ—Ä—ã–π)
- `$Config.Color.Prompt` - –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –∫ –≤–≤–æ–¥—É (–∑–µ–ª–µ–Ω—ã–π)
- `$Config.Color.Selection` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤—ã–±–æ—Ä–∫–µ (—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π)

## üö¶ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### MCP —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é PowerShell: `$PSVersionTable.PSVersion`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 8090 —Å–≤–æ–±–æ–¥–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤: `Get-ExecutionPolicy`

### Gemini CLI –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç MCP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `config/mcp_servers.json` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø—É—Ç–µ–π –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `start-mcp-gemini.ps1` –¥–ª—è –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ê–≥–µ–Ω—Ç—ã –Ω–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MCP

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ MCP —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å gemini CLI –≤ PATH

### –û—Ç–ª–∞–¥–∫–∞

–í–∫–ª—é—á–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

```powershell
# –î–ª—è –∞–≥–µ–Ω—Ç–æ–≤
$VerbosePreference = 'Continue'
Import-Module .\SmartAgents.psd1 -Verbose

# –î–ª—è MCP —Å–µ—Ä–≤–µ—Ä–∞
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥-—Ñ–∞–π–ª: %TEMP%\mcp-powershell-server.log
Get-Content "$env:TEMP\mcp-powershell-server.log" -Tail 20
```

## üìà –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```powershell
# 1. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã —Å MCP
.\start-mcp-gemini.ps1 -ApiKey "your-api-key" -LaunchGemini

# 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤
Start-FindSpecAgent

# 3. –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Gemini CLI —Å MCP
gemini --mcp-config ./config/mcp_servers.json -p "–ü–æ–∫–∞–∂–∏ —Ç–æ–ø-5 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø–∞–º—è—Ç–∏"
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏

```powershell
# –°–æ–∑–¥–∞–Ω–∏–µ –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
function Start-HybridAgent {
    # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∞–≥–µ–Ω—Ç–∞
    $Config = New-GeminiConfig -AppName '–ì–∏–±—Ä–∏–¥–Ω—ã–π –∞–≥–µ–Ω—Ç' -Emoji 'üîÄ'
    
    # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MCP –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
    function Get-SystemData {
        $mcpResult = Invoke-AgentPowerShell -Script "Get-Service | Where Status -eq 'Running'"
        return $mcpResult
    }
    
    # –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    # –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –∞–≥–µ–Ω—Ç–∞ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π MCP...
}
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è MCP –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∞–≥–µ–Ω—Ç–∞–º:

1. –î–æ–±–∞–≤—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `Invoke-AgentPowerShell`
2. –û–±–Ω–æ–≤–∏—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ PowerShell –∫–æ–º–∞–Ω–¥
3. –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ MCP —Å–µ—Ä–≤–µ—Ä–∞
4. –û–±–Ω–æ–≤–∏—Ç–µ —Å–ø—Ä–∞–≤–æ—á–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [Model Context Protocol Specification](https://modelcontextprotocol.io/)
- [Gemini CLI Documentation](https://github.com/google-gemini/gemini-cli)
- [PowerShell 7 Documentation](https://docs.microsoft.com/en-us/powershell/)

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

–ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –ø–∞–ø–∫–µ `examples/` (—Å–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏).

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–µ LICENSE.

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–æ—Ä–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –≤–∞—à–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏—Ö
4. –°–æ–∑–¥–∞–π—Ç–µ Pull Request —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

- –í—Å–µ MCP –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏
- –û–±–µ—Å–ø–µ—á—å—Ç–µ –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∞–≥–µ–Ω—Ç–∞–º–∏
- –î–æ–±–∞–≤–ª—è–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ PowerShell

---

**SmartAgents Framework v2.0.0** - —Ç–µ–ø–µ—Ä—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π MCP –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏!