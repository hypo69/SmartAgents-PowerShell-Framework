# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SmartAgents Framework

## –ü—Ä–æ–±–ª–µ–º—ã —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º PowerShell

#### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
–ö–æ–¥ —Å–º–µ—à–∏–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:
- –§–∞–π–ª—ã –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –ø—É–±–ª–∏—á–Ω—ã–µ –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã –ø–æ —Ä–∞–∑–Ω—ã–º –ø–∞–ø–∫–∞–º

#### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
SmartAgents/
‚îú‚îÄ‚îÄ SmartAgents.psm1              # –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å
‚îú‚îÄ‚îÄ SmartAgents.psd1              # –ú–∞–Ω–∏—Ñ–µ—Å—Ç –º–æ–¥—É–ª—è
‚îú‚îÄ‚îÄ Public/                       # –ü—É–±–ª–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ)
‚îÇ   ‚îú‚îÄ‚îÄ Start-FindSpecAgent.ps1
‚îÇ   ‚îú‚îÄ‚îÄ Start-FlightPlanAgent.ps1
‚îÇ   ‚îî‚îÄ‚îÄ Start-YourAgent.ps1
‚îú‚îÄ‚îÄ Private/                      # –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ)
‚îÇ   ‚îú‚îÄ‚îÄ New-GeminiConfig.ps1
‚îÇ   ‚îú‚îÄ‚îÄ Initialize-GeminiSession.ps1
‚îÇ   ‚îú‚îÄ‚îÄ Invoke-GeminiAPI.ps1
‚îÇ   ‚îî‚îÄ‚îÄ Write-ColoredMessage.ps1
‚îú‚îÄ‚îÄ Configs/                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ FindSpec/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GEMINI.md
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ShowHelp.md
‚îÇ   ‚îú‚îÄ‚îÄ FlightPlan/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GEMINI.md
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ShowHelp.md
‚îÇ   ‚îî‚îÄ‚îÄ Templates/                # –®–∞–±–ª–æ–Ω—ã –¥–ª—è –Ω–æ–≤—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ GEMINI.template.md
‚îÇ       ‚îî‚îÄ‚îÄ ShowHelp.template.md
‚îú‚îÄ‚îÄ Scripts/                      # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ Install-SmartAgents.ps1
‚îÇ   ‚îî‚îÄ‚îÄ Manage-Agents.ps1
‚îú‚îÄ‚îÄ Tests/                        # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ SmartAgents.Tests.ps1
‚îÇ   ‚îî‚îÄ‚îÄ Agents.Tests.ps1
‚îú‚îÄ‚îÄ Docs/                         # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ README.md
‚îÇ   ‚îú‚îÄ‚îÄ TUTORIAL.md
‚îÇ   ‚îî‚îÄ‚îÄ API-Reference.md
‚îî‚îÄ‚îÄ Examples/                     # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    ‚îú‚îÄ‚îÄ BasicUsage.ps1
    ‚îî‚îÄ‚îÄ CustomAgent.ps1
```

### 2. –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–æ–¥—É–ª—è

#### –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π SmartAgents.psm1

```powershell
## \file SmartAgents.psm1
# -*- coding: utf-8 -*-
#! .pyenv/bin/powershell

"""
SmartAgents Framework - –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å
======================================
–§—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö AI-–∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ PowerShell
—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Google Gemini API.

.. module:: SmartAgents
"""

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π –º–æ–¥—É–ª—è
$script:ModuleRoot = $PSScriptRoot
$script:PublicFunctionsPath = Join-Path $ModuleRoot 'Public'
$script:PrivateFunctionsPath = Join-Path $ModuleRoot 'Private'
$script:ConfigsPath = Join-Path $ModuleRoot 'Configs'

# –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª—è
$script:SmartAgentsConfig = @{
    Version = '1.0.0'
    Author = 'hypo69'
    DefaultModel = 'gemini-2.5-flash'
    SupportedModels = @('gemini-2.5-pro', 'gemini-2.5-flash')
    ConfigPath = $ConfigsPath
    LogLevel = 'Info'
}

# –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥—É–ª—è
function Initialize-SmartAgentsModule {
    """–§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –º–æ–¥—É–ª—å SmartAgents"""
    
    Write-Verbose "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è SmartAgents Framework v$($script:SmartAgentsConfig.Version)"
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
    $requirements = Test-SmartAgentsRequirements
    if (-not $requirements.IsValid) {
        Write-Warning "–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏:"
        $requirements.Issues | ForEach-Object { Write-Warning "  - $_" }
        return $false
    }
    
    # –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
    $privateFunctions = Get-ChildItem -Path $PrivateFunctionsPath -Filter '*.ps1' -ErrorAction SilentlyContinue
    foreach ($function in $privateFunctions) {
        try {
            . $function.FullName
            Write-Verbose "–ó–∞–≥—Ä—É–∂–µ–Ω–∞ –ø—Ä–∏–≤–∞—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: $($function.BaseName)"
        } catch {
            Write-Error "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ $($function.Name): $($_.Exception.Message)"
            return $false
        }
    }
    
    # –ó–∞–≥—Ä—É–∑–∫–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
    $publicFunctions = Get-ChildItem -Path $PublicFunctionsPath -Filter '*.ps1' -ErrorAction SilentlyContinue
    foreach ($function in $publicFunctions) {
        try {
            . $function.FullName
            Write-Verbose "–ó–∞–≥—Ä—É–∂–µ–Ω–∞ –ø—É–±–ª–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: $($function.BaseName)"
        } catch {
            Write-Error "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—É–±–ª–∏—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ $($function.Name): $($_.Exception.Message)"
            return $false
        }
    }
    
    Write-Verbose "SmartAgents Framework —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω"
    return $true
}

function Test-SmartAgentsRequirements {
    """–§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"""
    
    $result = @{
        IsValid = $true
        Issues = @()
    }
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ PowerShell
    if ($PSVersionTable.PSVersion.Major -lt 7) {
        $result.Issues += "–¢—Ä–µ–±—É–µ—Ç—Å—è PowerShell 7+. –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è: $($PSVersionTable.PSVersion)"
        $result.IsValid = $false
    }
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ Gemini CLI
    try {
        $null = Get-Command 'gemini' -ErrorAction Stop
    } catch {
        $result.Issues += "Gemini CLI –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ PATH"
        $result.IsValid = $false
    }
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ Out-ConsoleGridView
    try {
        $null = Get-Command 'Out-ConsoleGridView' -ErrorAction Stop
    } catch {
        $result.Issues += "Out-ConsoleGridView –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Microsoft.PowerShell.ConsoleGuiTools"
        $result.IsValid = $false
    }
    
    return $result
}

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
$initResult = Initialize-SmartAgentsModule
if (-not $initResult) {
    throw "–ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å SmartAgents Framework"
}

# –≠–∫—Å–ø–æ—Ä—Ç –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏)
$publicFunctionNames = (Get-ChildItem -Path $PublicFunctionsPath -Filter '*.ps1' -ErrorAction SilentlyContinue | 
                       ForEach-Object { $_.BaseName })

Export-ModuleMember -Function $publicFunctionNames

Write-Verbose "SmartAgents Framework –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ"
```

### 3. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –Ω–∞ —Ñ–∞–π–ª—ã

#### Private/New-GeminiConfig.ps1

```powershell
## \file Private/New-GeminiConfig.ps1
# -*- coding: utf-8 -*-
#! .pyenv/bin/powershell

"""
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–æ–≤ Gemini
===========================

.. module:: SmartAgents.Private.Config
"""

function New-GeminiConfig {
    """
    –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è –∞–≥–µ–Ω—Ç–∞ Gemini
    
    Args:
        AgentRoot (string): –ö–æ—Ä–Ω–µ–≤–∞—è –ø–∞–ø–∫–∞ –∞–≥–µ–Ω—Ç–∞
        AppName (string): –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        Emoji (string): –≠–º–æ–¥–∑–∏ –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        SessionPrefix (string): –ü—Ä–µ—Ñ–∏–∫—Å –¥–ª—è —Å–µ—Å—Å–∏–π
    
    Returns:
        hashtable: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞
    
    Example:
        >>> $config = New-GeminiConfig -AppName 'Test Agent' -Emoji 'ü§ñ' -SessionPrefix 'test' -AgentRoot $PSScriptRoot
        >>> $config.AppName
        Test Agent
    """
    [CmdletBinding()]
    param(
        [Parameter(Mandatory = $true)]
        [string]$AgentRoot,
        
        [Parameter(Mandatory = $true)]
        [string]$AppName,
        
        [Parameter(Mandatory = $true)]
        [string]$Emoji,
        
        [Parameter(Mandatory = $true)]
        [string]$SessionPrefix
    )
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏
    if (-not (Test-Path $AgentRoot)) {
        Write-Error "–ö–æ—Ä–Ω–µ–≤–∞—è –ø–∞–ø–∫–∞ –∞–≥–µ–Ω—Ç–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: $AgentRoot"
        return $null
    }
    
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    $configDir = Join-Path $script:SmartAgentsConfig.ConfigPath (Split-Path $AgentRoot -Leaf)
    $historyDir = Join-Path $configDir '.chat_history'
    
    # –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–ø–æ–∫ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
    if (-not (Test-Path $historyDir)) {
        try {
            New-Item -Path $historyDir -ItemType Directory -Force | Out-Null
            Write-Verbose "–°–æ–∑–¥–∞–Ω–∞ –ø–∞–ø–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏: $historyDir"
        } catch {
            Write-Error "–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞–ø–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏: $($_.Exception.Message)"
            return $null
        }
    }
    
    $config = @{
        AgentRoot = $AgentRoot
        HistoryDir = $historyDir
        ConfigDir = $configDir
        SessionPrefix = $SessionPrefix
        AppName = $AppName
        Emoji = $Emoji
        Color = @{
            Success = 'Green'
            Warning = 'Yellow'
            Info = 'Cyan'
            Error = 'Red'
            Prompt = 'Green'
            Selection = 'Magenta'
            Processing = 'Gray'
        }
        CreatedAt = Get-Date
        Version = $script:SmartAgentsConfig.Version
    }
    
    Write-Verbose "–°–æ–∑–¥–∞–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –∞–≥–µ–Ω—Ç–∞: $AppName"
    return $config
}
```

#### Private/Invoke-GeminiAPI.ps1

```powershell
## \file Private/Invoke-GeminiAPI.ps1
# -*- coding: utf-8 -*-
#! .pyenv/bin/powershell

"""
API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Gemini
==============================

.. module:: SmartAgents.Private.GeminiAPI
"""

function Invoke-GeminiAPI {
    """
    –§—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ Gemini API
    
    Args:
        Prompt (string): –¢–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞
        Model (string): –ú–æ–¥–µ–ª—å –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        Config (hashtable): –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞
    
    Returns:
        string | null: –û—Ç–≤–µ—Ç –æ—Ç API –∏–ª–∏ null –ø—Ä–∏ –æ—à–∏–±–∫–µ
    
    Raises:
        Exception: –ü—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö API
    
    Example:
        >>> $response = Invoke-GeminiAPI -Prompt "Hello" -Model "gemini-2.5-flash" -Config $config
        >>> if ($response) { Write-Host $response }
    """
    [CmdletBinding()]
    param(
        [Parameter(Mandatory = $true)]
        [string]$Prompt,
        
        [Parameter(Mandatory = $true)]
        [ValidateSet('gemini-2.5-pro', 'gemini-2.5-flash')]
        [string]$Model,
        
        [Parameter(Mandatory = $true)]
        [hashtable]$Config
    )
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è API –∫–ª—é—á–∞
    if (-not $env:GEMINI_API_KEY) {
        Write-ColoredMessage "API –∫–ª—é—á Gemini –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è" -Color $Config.Color.Error
        return $null
    }
    
    # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ (—Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ Verbose)
    Write-Verbose "–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ Gemini API (–º–æ–¥–µ–ª—å: $Model)"
    Write-Verbose "–î–ª–∏–Ω–∞ –ø—Ä–æ–º–ø—Ç–∞: $($Prompt.Length) —Å–∏–º–≤–æ–ª–æ–≤"
    
    try {
        # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∫ API
        $output = & gemini -m $Model -p $Prompt 2>&1
        $outputString = $output -join "`r`n"
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
        if ($outputString -match "429|Quota exceeded|RATE_LIMIT_EXCEEDED") {
            Write-ColoredMessage "`n[–û–®–ò–ë–ö–ê API] –ü—Ä–µ–≤—ã—à–µ–Ω–∞ –∫–≤–æ—Ç–∞ Google Gemini (–û—à–∏–±–∫–∞ 429)" -Color $Config.Color.Error
            Write-ColoredMessage "–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:" -Color $Config.Color.Warning
            Write-Host "  ‚Ä¢ API-–∫–ª—é—á –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω –∏–ª–∏ –∏—Å—á–µ—Ä–ø–∞–ª –ª–∏–º–∏—Ç—ã"
            Write-Host "  ‚Ä¢ –ù–µ –≤–∫–ª—é—á–µ–Ω –±–∏–ª–ª–∏–Ω–≥ –≤ Google Cloud Console"
            Write-Host "  ‚Ä¢ –ù–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω Generative Language API"
            Write-Host ""
            return $null
        }
        
        if ($outputString -match "401|UNAUTHENTICATED|Invalid API key") {
            Write-ColoredMessage "`n[–û–®–ò–ë–ö–ê API] –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á" -Color $Config.Color.Error
            Write-ColoredMessage "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π GEMINI_API_KEY" -Color $Config.Color.Warning
            return $null
        }
        
        if ($outputString -match "403|PERMISSION_DENIED") {
            Write-ColoredMessage "`n[–û–®–ò–ë–ö–ê API] –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω" -Color $Config.Color.Error
            Write-ColoredMessage "–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API –≤–∫–ª—é—á–µ–Ω –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞" -Color $Config.Color.Warning
            return $null
        }
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
        if ($LASTEXITCODE -ne 0) {
            throw "Gemini CLI –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π (–∫–æ–¥: $LASTEXITCODE): $outputString"
        }
        
        # –û—á–∏—Å—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–ª—É–∂–µ–±–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
        $cleanOutput = $outputString.Trim()
        $cleanOutput = $cleanOutput -replace "(?m)^Data collection is disabled\.`r?`n", ""
        $cleanOutput = $cleanOutput -replace "(?m)^Loaded cached credentials\.`r?`n", ""
        $cleanOutput = $cleanOutput -replace "(?m)^Using project:.*`r?`n", ""
        
        Write-Verbose "–ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç Gemini API (–¥–ª–∏–Ω–∞: $($cleanOutput.Length) —Å–∏–º–≤–æ–ª–æ–≤)"
        return $cleanOutput
        
    } catch {
        Write-ColoredMessage "`n–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ Gemini API: $($_.Exception.Message)" -Color $Config.Color.Error
        Write-Verbose "–°—Ç–µ–∫ –æ—à–∏–±–∫–∏: $($_.ScriptStackTrace)"
        return $null
    }
}

function Test-GeminiConnection {
    """
    –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Gemini API
    
    Args:
        Config (hashtable): –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞
    
    Returns:
        bool: True –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ, False –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ
    
    Example:
        >>> $isConnected = Test-GeminiConnection -Config $config
        >>> if ($isConnected) { Write-Host "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç" }
    """
    [CmdletBinding()]
    param(
        [Parameter(Mandatory = $true)]
        [hashtable]$Config
    )
    
    Write-Verbose "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Gemini API..."
    
    $testResponse = Invoke-GeminiAPI -Prompt "–û—Ç–≤–µ—Ç—å –æ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º: OK" -Model $script:SmartAgentsConfig.DefaultModel -Config $Config
    
    if ($testResponse -and $testResponse.Trim() -match "OK|ok|Ok") {
        Write-ColoredMessage "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Gemini API —É—Å–ø–µ—à–Ω–æ" -Color $Config.Color.Success
        return $true
    } else {
        Write-ColoredMessage "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Gemini API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ" -Color $Config.Color.Error
        return $false
    }
}
```

### 4. –®–∞–±–ª–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–≥–µ–Ω—Ç–æ–≤

#### Scripts/New-SmartAgent.ps1

```powershell
## \file Scripts/New-SmartAgent.ps1
# -*- coding: utf-8 -*-
#! .pyenv/bin/powershell

"""
–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–æ–≤—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ SmartAgents
===================================

.. module:: SmartAgents.Scripts.Generator
"""

function New-SmartAgent {
    """
    –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ SmartAgents –ø–æ —à–∞–±–ª–æ–Ω—É
    
    Args:
        Name (string): –ò–º—è –∞–≥–µ–Ω—Ç–∞
        DisplayName (string): –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è –∞–≥–µ–Ω—Ç–∞
        Emoji (string): –≠–º–æ–¥–∑–∏ –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        Description (string): –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –∞–≥–µ–Ω—Ç–∞
        OutputPath (string): –ü—É—Ç—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∞–≥–µ–Ω—Ç–∞
    
    Returns:
        bool: True –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º —Å–æ–∑–¥–∞–Ω–∏–∏, False –ø—Ä–∏ –æ—à–∏–±–∫–µ
    
    Example:
        >>> New-SmartAgent -Name "DataAnalyzer" -DisplayName "–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –¥–∞–Ω–Ω—ã—Ö" -Emoji "üìä" -Description "–ê–Ω–∞–ª–∏–∑ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö"
    """
    [CmdletBinding()]
    param(
        [Parameter(Mandatory = $true)]
        [ValidatePattern('^[A-Za-z][A-Za-z0-9]*$')]
        [string]$Name,
        
        [Parameter(Mandatory = $true)]
        [string]$DisplayName,
        
        [Parameter(Mandatory = $true)]
        [string]$Emoji,
        
        [Parameter(Mandatory = $true)]
        [string]$Description,
        
        [Parameter(Mandatory = $false)]
        [string]$OutputPath = $PWD
    )
    
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π
    $publicFunctionPath = Join-Path $OutputPath "Public\Start-$Name.ps1"
    $configPath = Join-Path $OutputPath "Configs\$Name"
    $geminiConfigPath = Join-Path $configPath "GEMINI.md"
    $helpConfigPath = Join-Path $configPath "ShowHelp.md"
    
    try {
        # –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–ø–æ–∫
        $null = New-Item -Path (Split-Path $publicFunctionPath) -ItemType Directory -Force
        $null = New-Item -Path $configPath -ItemType Directory -Force
        
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≥–µ–Ω—Ç–∞
        $functionTemplate = Get-AgentFunctionTemplate -Name $Name -DisplayName $DisplayName -Emoji $Emoji -Description $Description
        Set-Content -Path $publicFunctionPath -Value $functionTemplate -Encoding UTF8
        
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Gemini
        $geminiTemplate = Get-GeminiConfigTemplate -Name $Name -DisplayName $DisplayName -Description $Description
        Set-Content -Path $geminiConfigPath -Value $geminiTemplate -Encoding UTF8
        
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ø—Ä–∞–≤–∫–∏
        $helpTemplate = Get-HelpTemplate -Name $Name -DisplayName $DisplayName -Description $Description
        Set-Content -Path $helpConfigPath -Value $helpTemplate -Encoding UTF8
        
        Write-Host "–ê–≥–µ–Ω—Ç '$Name' —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!" -ForegroundColor Green